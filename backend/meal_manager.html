<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meal Manager</title>
    <link rel="icon" type="image/svg+xml" href="../assets/images/logo.svg" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="../assets/fontawesome-free-6.7.2-web/css/all.min.css"
    />
    <link rel="stylesheet" href="../assets/css/style-admin.css" />
    <link href="../assets/css/reset.css" rel="stylesheet" />
    <link rel="stylesheet" href="" />
    <link
      href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: #f8f9fa;
      }

      .modal-lg {
        max-width: 800px;
      }

      .hashtag-container {
        background-color: #ffffff;
        border-radius: 8px; /* Bo tr√≤n g√≥c v·ª´a ph·∫£i h∆°n */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* B√≥ng nh·∫π, gi·ªëng elevation 2 */
        padding: 30px;
        width: 100%;
        text-align: center;
      }

      h2 {
        color: #333;
        margin-bottom: 25px;
        font-size: 1.8em;
        font-weight: 500; /* ƒê·ªô ƒë·∫≠m v·ª´a ph·∫£i */
      }

      .hashtag-input-wrapper {
        border: 1px solid #e0e0e0; /* Vi·ªÅn nh·∫π */
        border-radius: 6px; /* Bo tr√≤n g√≥c */
        padding: 10px 15px;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        min-height: 55px; /* Chi·ªÅu cao t·ªëi thi·ªÉu */
        gap: 8px; /* Kho·∫£ng c√°ch gi·ªØa c√°c chip */
        background-color: #ffffff;
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
      }

      .hashtag-input-wrapper:focus-within {
        border-color: #1976d2; /* M√†u xanh d∆∞∆°ng ch·ªß ƒë·∫°o c·ªßa Vuetify */
        box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.2); /* Shadow xanh d∆∞∆°ng khi focus */
      }

      #hashtagInput {
        flex-grow: 1;
        border: none;
        outline: none;
        padding: 6px 0;
        font-size: 1em;
        min-width: 100px;
        color: #424242;
      }

      #hashtagInput::placeholder {
        color: #9e9e9e; /* M√†u placeholder nh·∫π nh√†ng */
      }

      .hashtag-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-wrap: wrap;
        gap: 8px; /* Kho·∫£ng c√°ch gi·ªØa c√°c chip */
        align-items: center;
      }

      /* --- Ph·∫ßn ch·ªânh s·ª≠a ƒë·ªÉ gi·ªëng Vuetify Chip --- */
      .hashtag-item {
        background-color: #e0e0e0; /* M√†u x√°m nh·∫°t, gi·ªëng default chip */
        color: #424242; /* M√†u ch·ªØ ƒë·∫≠m */
        border-radius: 16px; /* Bo tr√≤n g√≥c nhi·ªÅu h∆°n m·ªôt ch√∫t (ƒë·ªÉ gi·ªëng 16px c·ªßa Vuetify) */
        padding: 4px 12px; /* Padding nh·ªè g·ªçn */
        display: flex;
        align-items: center;
        gap: 4px; /* Kho·∫£ng c√°ch gi·ªØa ch·ªØ v√† n√∫t 'x' */
        font-size: 0.875em; /* K√≠ch th∆∞·ªõc font ƒëi·ªÉn h√¨nh c·ªßa Vuetify chip */
        font-weight: 500; /* ƒê·ªô ƒë·∫≠m v·ª´a ph·∫£i */
        white-space: nowrap;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.15); /* B√≥ng ƒë·ªï nh·∫π, gi·ªëng elevation 1 */
        transition: background-color 0.2s ease, box-shadow 0.2s ease,
          color 0.2s ease;
      }

      .hashtag-item:hover {
        background-color: #d6d6d6; /* H∆°i ƒë·∫≠m h∆°n khi hover */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* B√≥ng r√µ h∆°n khi hover, gi·ªëng elevation 2 */
        cursor: default; /* Kh√¥ng ph·∫£i pointer v√¨ n√∫t 'x' ƒë√£ l√† ri√™ng */
      }

      .hashtag-item .remove-tag {
        /* C√°c thu·ªôc t√≠nh ƒë·ªÉ n√∫t 'x' gi·ªëng icon close c·ªßa Vuetify */
        background: none; /* Kh√¥ng c√≥ n·ªÅn */
        border: none; /* Kh√¥ng vi·ªÅn */
        color: #616161; /* M√†u icon x√°m */
        cursor: pointer;
        font-size: 1.1em; /* K√≠ch th∆∞·ªõc icon */
        width: 20px; /* ƒê·∫£m b·∫£o k√≠ch th∆∞·ªõc c·ªë ƒë·ªãnh */
        height: 20px;
        border-radius: 50%; /* H√¨nh tr√≤n */
        display: flex;
        justify-content: center;
        align-items: center;
        margin-left: 4px; /* Kho·∫£ng c√°ch v·ªõi ch·ªØ */
        transition: background-color 0.2s ease, color 0.2s ease;
      }

      .hashtag-item .remove-tag:hover {
        background-color: #bdbdbd; /* N·ªÅn x√°m khi hover */
        color: #212121; /* Icon ƒëen h∆°n khi hover */
      }


      .instruction {
        font-size: 0.8em; /* K√≠ch th∆∞·ªõc nh·ªè h∆°n */
        color: #757575; /* M√†u x√°m ƒë·∫≠m h∆°n */
        margin-top: 20px;
      }
    </style>
  </head>

  <body>
    <div class="container-fluid">
      <div class="row">
        <!-- sidebar -->
        <nav
          id="sidebar"
          class="col-md-3 col-lg-2 d-md-block bg-dark sidebar collapse"
        >
          <div class="position-sticky pt-3">
            <div
              class="logo-admin text-center pt-3 d-flex align-items-center justify-content-center"
            >
              <a href="#">
                <i class="fas fa-seedling"></i>
                <span>NutriPlanner</span>
              </a>
            </div>
            <ul class="nav flex-column">
              <li class="nav-item">
                <a href="./admin.php" class="nav-link text-white tab-btn">
                  <i class="fa fa-tachometer-alt me-2"></i> Dashboard
                </a>
              </li>
              <li class="nav-item">
                <a
                  href="./meal_manager.html"
                  class="nav-link active text-white tab-btn"
                >
                  <i class="fa fa-utensils me-2"></i> Meal manager
                </a>
              </li>
              <li class="nav-item">
                <a
                  href="./material_manager.html"
                  class="nav-link text-white tab-btn"
                >
                  <i class="fa fa-tags me-2"></i> Material management
                </a>
              </li>
              <li class="nav-item">
                <a
                  href="./user_manager.html"
                  class="nav-link text-white tab-btn"
                >
                  <i class="fa fa-users me-2"></i> User management
                </a>
              </li>
              <li class="nav-item">
                <a
                  href="./feedback_manager.html"
                  class="nav-link text-white tab-btn"
                >
                  <i class="fa fa-comments me-2"></i> Feedback
                </a>
              </li>
            </ul>
          </div>
        </nav>
        <!-- main content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
          <div
            class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"
          >
            <h1 class="h2 fw-bold">Meal Manager</h1>
            <div class="btn-toolbar mb-2 mb-md-0">
              <div class="dropdown">
                <button
                  class="btn btn-sm btn-outline-none dropdown-toggle"
                  data-bs-toggle="dropdown"
                  type="button"
                >
                  <img
                    src="../assets/images/admin.jpg"
                    alt="admin"
                    class="rounded-circle"
                    width="30"
                  />
                  <span class="text-login">Admin</span>
                </button>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="profile.html">H·ªì s∆°</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="login.html">ƒêƒÉng xu·∫•t</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="container-fluid py-4">
            <div class="card mb-4">
              <div class="card-body">
                <form id="searchForm">
                  <div class="row g-3">
                    <div class="col-md-3">
                      <label class="form-label">T√™n m√≥n ƒÉn</label>
                      <input
                        type="text"
                        class="form-control"
                        name="search_name"
                        placeholder="Nh·∫≠p t√™n m√≥n ƒÉn..."
                      />
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Lo·∫°i b·ªØa ƒÉn</label>
                      <select class="form-select" name="search_type">
                        <option value="">T·∫•t c·∫£</option>
                        <option value="1">B·ªØa s√°ng</option>
                        <option value="2">B·ªØa tr∆∞a</option>
                        <option value="3">B·ªØa t·ªëi</option>
                        <option value="4">ƒÇn v·∫∑t</option>
                      </select>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Ch·∫ø ƒë·ªô ƒÉn</label>
                      <select class="form-select" name="search_tag">
                        <option value="">T·∫•t c·∫£</option>
                        <option value="1">Vegan</option>
                        <option value="2">Vegetarian</option>
                        <option value="3">Keto</option>
                        <option value="4">Paleo</option>
                        <option value="5">Low Carb</option>
                        <option value="6">High Protein</option>
                      </select>
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">Tr·∫°ng th√°i</label>
                      <select class="form-select" name="search_status">
                        <option value="">T·∫•t c·∫£</option>
                        <option value="visible">Hi·ªÉn th·ªã</option>
                        <option value="hidden">·∫®n</option>
                      </select>
                    </div>
                    <div class="col-12">
                      <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">
                          <i class="fas fa-search me-2"></i>T√¨m ki·∫øm
                        </button>
                        <button type="reset" class="btn btn-light border">
                          <i class="fas fa-redo me-2"></i>ƒê·∫∑t l·∫°i
                        </button>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-4">
              <button
                class="btn btn-success add-meal-btn"
                data-bs-toggle="modal"
                data-bs-target="#mealModal"
              >
                <i class="fa fa-plus"></i> Th√™m b·ªØa ƒÉn
              </button>
            </div>
            <div class="card">
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-striped align-middle">
                    <thead class="table-light">
                      <tr>
                        <th>ID</th>
                        <th>T√™n B·ªØa ƒÇn</th>
                        <th>Danh M·ª•c</th>
                        <th>Calo</th>
                        <th>Tags</th>
                        <th>Ng√†y T·∫°o</th>
                        <th>Tr·∫°ng Th√°i</th>
                        <th class="text-center">Thao T√°c</th>
                      </tr>
                    </thead>
                    <tbody id="body_listmeals">
                      <tr>
                        <td>1</td>
                        <td>Salad C√° H·ªìi</td>
                        <td>B·ªØa Tr∆∞a</td>
                        <td>450</td>
                        <td>Keto, High Protein</td>
                        <td>01/06/2024</td>
                        <td><span class="badge bg-success">Hi·ªÉn th·ªã</span></td>
                        <td class="text-center">
                          <button class="btn btn-sm btn-primary">
                            <i class="fa-solid fa-pencil"></i>
                          </button>
                          <button class="btn btn-sm btn-danger">
                            <i class="fa-solid fa-trash"></i>
                          </button>
                        </td>
                      </tr>
                      <tr>
                        <td>2</td>
                        <td>Ch√°o Y·∫øn M·∫°ch</td>
                        <td>B·ªØa S√°ng</td>
                        <td>320</td>
                        <td>Vegan</td>
                        <td>02/06/2024</td>
                        <td><span class="badge bg-secondary">·∫®n</span></td>
                        <td class="text-center">
                          <button class="btn btn-sm btn-primary">
                            <i class="fa-solid fa-pencil"></i>
                          </button>
                          <button class="btn btn-sm btn-danger">
                            <i class="fa-solid fa-trash"></i>
                          </button>
                        </td>
                      </tr>
                      <!-- Th√™m d√≤ng m·∫´u kh√°c n·∫øu mu·ªën -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <!-- Modal Th√™m/S·ª≠a B·ªØa ƒÇn -->
          <div
            class="modal fade"
            id="mealModal"
            tabindex="-1"
            aria-labelledby="mealModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title fw-bold" id="mealModalLabel">
                    Th√™m B·ªØa ƒÇn M·ªõi
                  </h5>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body">
                  <form id="mealForm" >
                    <!-- Th√¥ng tin c∆° b·∫£n -->
                    <div class="card mb-3">
                      <div class="card-header bg-light">
                        <h6 class="mb-0">Th√¥ng tin c∆° b·∫£n</h6>
                      </div>
                      <div class="card-body">
                        <div class="row g-2">
                          <div class="col-md-6">
                            <label class="form-label">T√™n m√≥n ƒÉn</label>
                            <input required name="name" class="form-control" />
                          </div>
                          <div class="col-md-3">
                            <label class="form-label"
                              >Th·ªùi gian n·∫•u (ph√∫t)</label
                            >
                            <input
                              name="prep_time"
                              type="number"
                              class="form-control"
                            />
                          </div>
                          <div class="col-md-3">
                            <label class="form-label">Calories</label>
                            <input
                              name="calories"
                              type="number"
                              class="form-control"
                              required
                            />
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Ph√¢n lo·∫°i m√≥n ƒÉn -->
                    <div class="card mb-3">
                      <div class="card-header bg-light">
                        <h6 class="mb-0">Ph√¢n lo·∫°i</h6>
                      </div>
                      <div class="card-body">
                        <div class="row g-2">
                          <div class="col-md-12">
                            <label class="form-label">Lo·∫°i b·ªØa ƒÉn</label>
                            <div class="d-flex gap-3">
                              <div class="form-check">
                                <input
                                  class="form-check-input"
                                  type="checkbox"
                                  name="meal_types"
                                  value="Breakfast"
                                  id="type_breakfast"
                                />
                                <label
                                  class="form-check-label"
                                  for="type_breakfast"
                                  >Breakfast</label
                                >
                              </div>
                              <div class="form-check">
                                <input
                                  class="form-check-input"
                                  type="checkbox"
                                  name="meal_types"
                                  value="Lunch"
                                  id="type_lunch"
                                />
                                <label class="form-check-label" for="type_lunch"
                                  >Lunch</label
                                >
                              </div>
                              <div class="form-check">
                                <input
                                  class="form-check-input"
                                  type="checkbox"
                                  name="meal_types"
                                  value="Dinner"
                                  id="type_dinner"
                                />
                                <label
                                  class="form-check-label"
                                  for="type_dinner"
                                  >Dinner</label
                                >
                              </div>
                              <div class="form-check">
                                <input
                                  class="form-check-input"
                                  type="checkbox"
                                  name="meal_types"
                                  value="Snacks"
                                  id="type_snack"
                                />
                                <label class="form-check-label" for="type_snack"
                                  >Snacks</label
                                >
                              </div>
                              <div class="form-check">
                                <input
                                  class="form-check-input"
                                  type="checkbox"
                                  name="meal_types"
                                  value="Smooth√≠e"
                                  id="type_snack"
                                />
                                <label class="form-check-label" for="type_snack"
                                  >Smoothies</label
                                >
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Th√¥ng tin dinh d∆∞·ª°ng -->
                    <div class="card mb-3">
                      <div class="card-header bg-light">
                        <h6 class="mb-0">Th√¥ng tin dinh d∆∞·ª°ng</h6>
                      </div>
                      <div class="card-body">
                        <div class="row g-3">
                          <div class="col-md-4">
                            <label class="form-label">Protein</label>
                            <div class="input-group">
                              <input
                                name="protein"
                                type="number"
                                class="form-control"
                              />
                              <span class="input-group-text">g</span>
                            </div>
                          </div>
                          <div class="col-md-4">
                            <label class="form-label">Carbs</label>
                            <div class="input-group">
                              <input
                                name="carbs"
                                type="number"
                                class="form-control"
                              />
                              <span class="input-group-text">g</span>
                            </div>
                          </div>
                          <div class="col-md-4">
                            <label class="form-label">Ch·∫•t b√©o</label>
                            <div class="input-group">
                              <input
                                name="fats"
                                type="number"
                                class="form-control"
                              />
                              <span class="input-group-text">g</span>
                            </div>
                          </div>
                          <div class="col-md-4">
                            <label class="form-label">Ch·∫•t x∆°</label>
                            <div class="input-group">
                              <input
                                name="fiber"
                                type="number"
                                class="form-control"
                              />
                              <span class="input-group-text">g</span>
                            </div>
                          </div>
                          <div class="col-md-4">
                            <label class="form-label">ƒê∆∞·ªùng</label>
                            <div class="input-group">
                              <input
                                name="sugar"
                                type="number"
                                class="form-control"
                              />
                              <span class="input-group-text">g</span>
                            </div>
                          </div>
                          <div class="col-md-4">
                            <label class="form-label">Natri</label>
                            <div class="input-group">
                              <input
                                name="sodium"
                                type="number"
                                class="form-control"
                              />
                              <span class="input-group-text">mg</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Tags v√† ch·∫ø ƒë·ªô ƒÉn -->
                    <div class="card mb-3">
                      <nav class="card-header bg-light">
                        <div class="nav nav-tabs" id="nav-tab" role="tablist">
                          <button
                            class="nav-link active"
                            id="nav-description-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#nav-description"
                            type="button"
                            role="tab"
                            aria-controls="nav-description"
                            aria-selected="true"
                          >
                            Description
                          </button>
                          <button
                            class="nav-link"
                            id="nav-ingredients-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#nav-ingredients"
                            type="button"
                            role="tab"
                            aria-controls="nav-ingredients"
                            aria-selected="false"
                          >
                            Ingredients
                          </button>
                          <button
                            class="nav-link"
                            id="nav-instruction-tab"
                            data-bs-toggle="tab"
                            data-bs-target="#nav-instruction"
                            type="button"
                            role="tab"
                            aria-controls="nav-instruction"
                            aria-selected="false"
                          >
                            Instruction
                          </button>
                        </div>
                      </nav>
                      <div class="tab-content card-body" id="nav-tabContent">
                        <div
                          class="tab-pane fade show active"
                          id="nav-description"
                          role="tabpanel"
                          aria-labelledby="nav-description-tab"
                        >
                          <div
                            id="editor__description"
                            style="height: 200px"
                          ></div>
                          <input
                            type="hidden"
                            name="description"
                            id="description"
                          />
                        </div>

                        <div
                          class="tab-pane fade"
                          id="nav-ingredients"
                          role="tabpanel"
                          aria-labelledby="nav-profile-tab"
                        >
                          <div
                            id="editor__ingredients"
                            style="height: 200px"
                          ></div>
                          <input
                            type="hidden"
                            name="ingredients"
                            id="ingredients"
                          />
                        </div>
                        <div
                          class="tab-pane fade"
                          id="nav-instruction"
                          role="tabpanel"
                          aria-labelledby="nav-instruction-tab"
                        >
                          <div
                            id="editor__instruction"
                            style="height: 200px"
                          ></div>
                          <input
                            type="hidden"
                            name="instruction"
                            id="instruction"
                          />
                        </div>
                      </div>
                    </div>
                    <div class="card mb-3">
                      <div class="card-header bg-light">
                        <h6>Th√™m Hashtag cho M√≥n ƒÇn</h6>
                      </div>

                      <div class="hashtag-container card-body py-0 my-3">
                        <p class="instruction m-0 py-3">
                          M·∫πo: G√µ hashtag, nh·∫•n Enter ho·∫∑c d·∫•u ph·∫©y ƒë·ªÉ th√™m.
                          Nh·∫•n 'x' ƒë·ªÉ x√≥a.
                        </p>
                        <div class="hashtag-input-wrapper">
                          <input
                            type="text"
                            id="hashtagInput"
                            placeholder="Nh·∫≠p hashtag v√† nh·∫•n Enter ho·∫∑c d·∫•u ph·∫©y (,)"
                          />

                        </div>
                        <div class="py-3">
                          <ul id="hashtagList" class="hashtag-list"></ul>
                        </div>
                      </div>
                    </div>

                    <!-- H√¨nh ·∫£nh v√† tr·∫°ng th√°i -->
                    <div class="card mb-3">
                      <div class="card-header bg-light">
                        <h6 class="mb-0">H√¨nh ·∫£nh v√† tr·∫°ng th√°i</h6>
                      </div>
                      <div class="card-body">
                        <div class="row g-3">
                          <div class="col-md-6">
                            <label class="form-label">H√¨nh ·∫£nh m√≥n ƒÉn</label>
                            <input
                              name="image"
                              type="file"
                              class="form-control"
                              accept="image/*"
                            />
                          </div>
                          <div class="col-md-6">
                            <label class="form-label">Tr·∫°ng th√°i</label>
                            <select name="status" class="form-select">
                              <option value="visible">Hi·ªÉn th·ªã</option>
                              <option value="hidden">·∫®n</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="d-flex justify-content-end gap-2 mt-3">
                      <button
                        type="button"
                        class="btn btn-light border"
                        data-bs-dismiss="modal"
                      >
                        H·ªßy
                      </button>
                      <button type="submit" class="btn btn-primary px-4">
                        L∆∞u m√≥n ƒÉn
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script>
      let hashtags = []; // M·∫£ng ƒë·ªÉ l∆∞u tr·ªØ c√°c hashtagX
      document.addEventListener("DOMContentLoaded", () => {
        const hashtagInput = document.getElementById("hashtagInput");
        const hashtagList = document.getElementById("hashtagList");
        
        const renderHashtags = () => {
          hashtagList.innerHTML = "";
          hashtags.forEach((tag, index) => {
            const li = document.createElement("li");
            li.className = "hashtag-item";

            const span = document.createElement("span");
            span.className = "value__tag"; // üëà Th√™m class v√†o ƒë√¢y
            span.textContent = tag; // An to√†n

            const button = document.createElement("button");
            button.type = "button";
            button.className = "remove-tag";
            button.dataset.index = index;
            button.textContent = "x";

            li.appendChild(span);
            li.appendChild(button);
            hashtagList.appendChild(li);
          });
        };

        // H√†m ƒë·ªÉ th√™m m·ªôt hashtag
        const addHashtag = (tag) => {
          const cleanedTag = tag.trim().toLowerCase(); // X√≥a kho·∫£ng tr·∫Øng v√† chuy·ªÉn v·ªÅ ch·ªØ th∆∞·ªùng
          if (cleanedTag && !hashtags.includes(cleanedTag)) {
            // Ch·ªâ th√™m n·∫øu kh√¥ng r·ªóng v√† ch∆∞a t·ªìn t·∫°i
            hashtags.push(cleanedTag);
            renderHashtags();
          }
        };

        // H√†m ƒë·ªÉ x√≥a m·ªôt hashtag
        const removeHashtag = (index) => {
          hashtags.splice(index, 1); // X√≥a ph·∫ßn t·ª≠ t·∫°i v·ªã tr√≠ index
          renderHashtags();
        };

        // L·∫Øng nghe s·ª± ki·ªán b√†n ph√≠m tr√™n tr∆∞·ªùng input
        hashtagInput.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === ",") {
            // Th√™m hashtag khi nh·∫•n Enter ho·∫∑c d·∫•u ph·∫©y
            e.preventDefault(); // NgƒÉn ch·∫∑n h√†nh vi m·∫∑c ƒë·ªãnh (v√≠ d·ª•: t·∫°o d√≤ng m·ªõi)
            const inputValue = hashtagInput.value;
            if (inputValue) {
              addHashtag(inputValue);
              hashtagInput.value = ""; // X√≥a n·ªôi dung trong input sau khi th√™m
            }
          }
        });

        // L·∫Øng nghe s·ª± ki·ªán click tr√™n c√°c n√∫t 'x' (x√≥a hashtag)
        hashtagList.addEventListener("click", (e) => {
          if (e.target.classList.contains("remove-tag")) {
            const index = parseInt(e.target.dataset.index); // L·∫•y index t·ª´ data-index
            removeHashtag(index);
          }
        });

        // (T√πy ch·ªçn) X·ª≠ l√Ω d√°n vƒÉn b·∫£n c√≥ nhi·ªÅu hashtag
        hashtagInput.addEventListener("paste", (e) => {
          e.preventDefault();
          const pasteData = e.clipboardData.getData("text");
          const tags = pasteData
            .split(/[\s,]+/)
            .filter((tag) => tag.trim() !== ""); // T√°ch theo kho·∫£ng tr·∫Øng ho·∫∑c d·∫•u ph·∫©y
          tags.forEach((tag) => addHashtag(tag));
          hashtagInput.value = "";
        });

        // (T√πy ch·ªçn) Kh·ªüi t·∫°o v·ªõi m·ªôt v√†i hashtag demo
      });


    </script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const tabbutton = document.querySelectorAll(".tab-btn");

        tabbutton.forEach((button) => {
          button.addEventListener("click", () => {
            tabbutton.forEach((btn) => btn.classList.remove("active"));
            button.classList.add("active");
          });
        });

        const searchForm = document.getElementById("searchForm");
        const tableBody = document.querySelector("table tbody");

        // X·ª≠ l√Ω s·ª± ki·ªán submit form t√¨m ki·∫øm
        searchForm.addEventListener("submit", async (e) => {
          e.preventDefault();

          // L·∫•y gi√° tr·ªã t·ª´ form
          const formData = new FormData(searchForm);
          const searchParams = new URLSearchParams();

          // Chuy·ªÉn ƒë·ªïi FormData th√†nh URLSearchParams
          formData.forEach((value, key) => {
            if (value) searchParams.append(key, value);
          });

          try {
            // G·ªçi API t√¨m ki·∫øm
            const response = await fetch(
              `search.php?${searchParams.toString()}`
            );
            const result = await response.json();

            if (result.status === "success") {
              // X√≥a d·ªØ li·ªáu c≈© trong b·∫£ng
              tableBody.innerHTML = "";

              // Hi·ªÉn th·ªã k·∫øt qu·∫£ m·ªõi
              result.data.forEach((meal) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                                <td>${meal.id}</td>
                                <td>${meal.name}</td>
                                <td>${meal.meal_types.join(", ")}</td>
                                <td>${meal.calories}</td>
                                <td>${meal.diet_tags.join(", ")}</td>
                                <td>${meal.created_at}</td>
                                <td><span class="badge bg-${
                                  meal.status === "visible"
                                    ? "success"
                                    : "secondary"
                                }">${meal.status}</span></td>
                                <td class="text-center">
                                    <button class="btn btn-sm btn-primary" onclick="editMeal(${
                                      meal.id
                                    })">
                                        <i class="fa-solid fa-pencil"></i>
                                    </button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteMeal(${
                                      meal.id
                                    })">
                                        <i class="fa-solid fa-trash"></i>
                                    </button>
                                </td>
                            `;
                tableBody.appendChild(row);
              });
            } else {
              alert("C√≥ l·ªói x·∫£y ra khi t√¨m ki·∫øm");
            }
          } catch (error) {
            console.error("Error:", error);
            alert("Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server");
          }
        });

        // X·ª≠ l√Ω n√∫t reset
        searchForm.addEventListener("reset", () => {
          setTimeout(() => searchForm.dispatchEvent(new Event("submit")), 10);
        });
      });

      // C√°c h√†m x·ª≠ l√Ω kh√°c
      function editMeal(id) {
        // TODO: Implement edit functionality
        console.log("Edit meal:", id);
      }

      function deleteMeal(id) {
        console.log("Delete meal:", id);
        meals = meals.filter((meal) => meal.id !== id);
        console.log(meals);
        render(meals);
        fetch("admin.php", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            id: id,
          }),
        });
      }
    </script>
    <script>
      let meals = [];

      async function listmeals() {
        let res = await fetch("../meals.json");
        const data = await res.json();
        meals = data;
        render(meals);
      }
      listmeals();
      const render = (meals) => {
        document.getElementById("body_listmeals").innerHTML = "";
        meals.forEach((meal) => {
          let tagHtml = "";
          meal.tags.forEach((tag) => {
            tagHtml += `<button class="btn btn-success mx-1 p-1">${tag}</button>`;
          });

          let element = document.createElement("tr");
          element.innerHTML = `
                                    <td>${meal.id}</td>
                                    <td>${meal.name}</td>
                                    <td>${meal.type}</td>
                                    <td>${meal.calories}</td>
                                    <td>${tagHtml}</td>
                                    <td>${meal.create_at}</td>
                                    <td><span class="badge bg-${
                                      meal.status === "visible"
                                        ? "success"
                                        : "secondary"
                                    }">${meal.status}</span></td>
                                    <td class="text-center">
                                        <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#mealModal" onclick="editMeal(${
                                          meal.id
                                        })">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="btn btn-sm btn-danger" onclick="deleteMeal(${
                                          meal.id
                                        })">
                                            <i class="fa-solid fa-trash"></i>
                                        </button>
                                    </td>
                                `;
          document.getElementById("body_listmeals").appendChild(element);
        });
      };

      const quill = new Quill("#editor__description", { theme: "snow" });
      const quill2 = new Quill("#editor__ingredients", { theme: "snow" });
      const quill3 = new Quill("#editor__instruction", { theme: "snow" });
      //x·ª≠ l√Ω form
      document
        .getElementById("mealForm")
        .addEventListener("submit", function (e) {
          e.preventDefault(); // NgƒÉn form reload trang

          document.getElementById("description").value = quill.root.innerHTML;
          document.getElementById("ingredients").value = quill2.root.innerHTML;
          document.getElementById("instruction").value = quill3.root.innerHTML;
          const formData = new FormData(this);
          formData.append('hashtags',hashtags.join(","));

          fetch(" upload.php", {
            method: "POST",
            body: formData,
          })
            .then(async (res) => {
              const text = await res.text(); // l·∫•y nguy√™n n·ªôi dung tr·∫£ v·ªÅ
              console.log("Raw response:", text);
              try {
                const data = JSON.parse(text);
                if (data.status === "success") {
                  alert("Upload th√†nh c√¥ng! ƒê∆∞·ªùng d·∫´n: " + data.path);
                } else {
                  alert("Upload th·∫•t b·∫°i!");
                }
              } catch (e) {
                console.error("Kh√¥ng th·ªÉ parse JSON:", e);
              }
            })
            .catch((err) => {
              console.error("L·ªói fetch:", err);
            });
        });
    </script>
  </body>
</html>
